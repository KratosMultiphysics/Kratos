from __future__ import print_function, absolute_import, division #makes KratosMultiphysics backward compatible with python 2.6 and 2.7
#
#
import numpy as np
from numpy import linalg as la
#
#
# setting the domain size for the problem to be solved
#
import sys
from KratosMultiphysics import *
from KratosMultiphysics.IncompressibleFluidApplication import *
from KratosMultiphysics.FluidDynamicsApplication import *
from KratosMultiphysics.ExternalSolversApplication import *
from KratosMultiphysics.MeshingApplication import *
from KratosMultiphysics.SolidMechanicsApplication import *

# ADI BEGIN
from KratosMultiphysics.ALEApplication import *
from KratosMultiphysics.EmpireApplication import *
import empire_mapper
# ADI END

# defining variables to be used
# GID IO IS NOT USING THIS NOW. TO BE REMOVED ONCE THE "PRINT IN POINTS"
# CODE IS NOT USING IT

variables_dictionary = {"DISPLACEMENT": DISPLACEMENT,
                        "PRESSURE": PRESSURE,
                        "VELOCITY": VELOCITY,
                        "REACTION": REACTION,
                        "DISTANCE": DISTANCE, }

# defining a model part for the fluid
mesh1_model_part = ModelPart("mesh1_coarse")
mesh2_model_part = ModelPart("mesh2_fine")

mesh1_model_part.AddNodalSolutionStepVariable(DISPLACEMENT)
mesh1_model_part.AddNodalSolutionStepVariable(PATCH_INDEX)
mesh2_model_part.AddNodalSolutionStepVariable(VELOCITY)
mesh2_model_part.AddNodalSolutionStepVariable(PATCH_INDEX)


## Importing the coarse mesh
nodes = np.array([-1.15310000,7.16447000,0.00000000,-1.15310000,6.26891000,0.00000000,0.00000000,7.16447000,0.00000000,-0.62281600,6.08223000,0.00000000,0.00000000,6.44298000,0.00000000,-1.15310000,5.37335000,0.00000000,0.00000000,5.72149000,0.00000000,0.00000000,5.00000000,0.00000000,-1.15310000,4.47779000,0.00000000,0.84807700,5.00000000,0.00000000,-0.42584100,4.26450000,0.00000000,0.42403800,4.26388000,0.00000000,1.69615000,5.00000000,0.00000000,-1.15310000,3.58223000,0.00000000,1.30907000,4.24587000,0.00000000,0.92440800,3.48822000,0.00000000,2.54423000,5.00000000,0.00000000,-0.00250684,2.93355000,0.00000000,2.15684000,4.28791000,0.00000000,-1.15310000,2.68668000,0.00000000,1.77282000,3.53495000,0.00000000,-0.42989800,2.19887000,0.00000000,3.39231000,5.00000000,0.00000000,2.98741000,4.27013000,0.00000000,2.61589000,3.59549000,0.00000000,0.41990600,2.19599000,0.00000000,-1.15310000,1.79112000,0.00000000,2.24708000,2.83099000,0.00000000,1.26822000,2.19099000,0.00000000,3.81921000,4.33907000,0.00000000,4.24038000,5.00000000,0.00000000,-0.00690896,1.46181000,0.00000000,3.46411000,3.57099000,0.00000000,2.11524000,2.18342000,0.00000000,3.02312000,2.85101000,0.00000000,0.84001900,1.45795000,0.00000000,-1.15310000,0.89555900,0.00000000,1.68576000,1.45183000,0.00000000,4.21720000,3.59839000,0.00000000,-0.43245600,0.72714800,0.00000000,4.65804000,4.28111000,0.00000000,5.08846000,5.00000000,0.00000000,3.86742000,2.84906000,0.00000000,0.41356700,0.72423400,0.00000000,2.52905000,1.44286000,0.00000000,3.44357000,2.11392000,0.00000000,1.25813000,0.71945100,0.00000000,5.02379000,3.69760000,0.00000000,-1.15310000,0.00000000,0.00000000,5.49391000,4.33933000,0.00000000,2.10040000,0.71201800,0.00000000,4.71035000,2.91738000,0.00000000,0.00000000,0.00000000,0.00000000,3.36713000,1.43178000,0.00000000,5.88390000,5.00000000,0.00000000,0.84807700,0.00000000,0.00000000,4.34739000,2.15248000,0.00000000,2.93936000,0.70156400,0.00000000,1.69615000,0.00000000,0.00000000,5.81452000,3.78463000,0.00000000,5.49970000,3.00941000,0.00000000,4.19397000,1.42413000,0.00000000,6.25490000,4.43659000,0.00000000,5.19028000,2.23223000,0.00000000,6.60346000,5.00000000,0.00000000,2.54423000,0.00000000,0.00000000,3.77435000,0.68990300,0.00000000,5.04284000,1.41456000,0.00000000,6.60091000,3.76059000,0.00000000,6.25102000,3.03358000,0.00000000,3.39231000,0.00000000,0.00000000,6.91726000,4.45096000,0.00000000,4.60690000,0.68612100,0.00000000,7.26259000,5.00000000,0.00000000,6.18055000,2.19183000,0.00000000,4.24038000,0.00000000,0.00000000,7.29487000,3.86657000,0.00000000,5.74394000,1.21416000,0.00000000,7.05105000,3.13806000,0.00000000,7.61314000,4.48988000,0.00000000,7.87333000,5.00000000,0.00000000,5.42429000,0.50030300,0.00000000,5.08846000,0.00000000,0.00000000,6.97599000,2.21143000,0.00000000,8.14135000,4.56846000,0.00000000,6.62325000,1.33429000,0.00000000,6.10339000,0.51949600,0.00000000,8.44524000,5.00000000,0.00000000,7.89257000,3.28212000,0.00000000,8.18943000,4.05330000,0.00000000,5.88390000,0.00000000,0.00000000,7.74867000,2.40886000,0.00000000,8.66890000,4.55190000,0.00000000,7.36003000,1.60213000,0.00000000,8.98615000,5.00000000,0.00000000,6.82444000,0.51382400,0.00000000,7.22987000,0.99524000,0.00000000,8.37001000,2.79569000,0.00000000,8.70140000,3.43026000,0.00000000,6.60346000,0.00000000,0.00000000,8.94054000,4.02975000,0.00000000,9.21793000,4.54887000,0.00000000,8.45326000,2.21072000,0.00000000,8.11176000,1.59061000,0.00000000,9.50256000,5.00000000,0.00000000,7.84201000,1.02514000,0.00000000,7.49959000,0.50082500,0.00000000,7.26259000,0.00000000,0.00000000,9.04980000,2.84450000,0.00000000,9.49241000,4.05156000,0.00000000,9.75128000,4.55717000,0.00000000,9.49482000,3.46010000,0.00000000,8.40094000,1.03483000,0.00000000,10.00000000,5.00000000,0.00000000,8.75417000,1.56993000,0.00000000,8.12351000,0.46574500,0.00000000,9.14990000,2.12970000,0.00000000,7.87333000,0.00000000,0.00000000,10.08120000,4.00296000,0.00000000,9.69328000,2.57020000,0.00000000,10.31950000,4.48739000,0.00000000,10.48770000,4.95196000,0.00000000,8.68955000,0.47132600,0.00000000,9.07032000,0.99470700,0.00000000,8.44524000,0.00000000,0.00000000,9.42000000,1.49963000,0.00000000,10.50510000,3.29146000,0.00000000,10.71650000,3.97969000,0.00000000,10.95670000,4.80970000,0.00000000,10.89760000,4.41037000,0.00000000,9.24534000,0.43638700,0.00000000,8.98615000,0.00000000,0.00000000,10.17720000,2.02914000,0.00000000,9.91192000,0.95612900,0.00000000,10.71980000,2.50963000,0.00000000,11.38890000,4.57867000,0.00000000,11.17420000,3.57614000,0.00000000,9.50256000,0.00000000,0.00000000,11.32110000,4.10982000,0.00000000,9.77201000,0.37189700,0.00000000,10.42960000,1.40358000,0.00000000,10.83630000,1.88538000,0.00000000,10.20020000,0.46696900,0.00000000,11.76780000,4.26777000,0.00000000,10.00000000,0.00000000,0.00000000,11.49440000,2.86763000,0.00000000,11.73410000,3.61022000,0.00000000,10.61410000,0.74115900,0.00000000,11.01790000,1.27581000,0.00000000,11.48980000,2.21316000,0.00000000,12.07870000,3.88893000,0.00000000,10.48770000,0.04803680,0.00000000,11.40140000,1.66868000,0.00000000,12.00200000,3.12424000,0.00000000,12.01990000,2.69894000,0.00000000,11.22970000,0.76599800,0.00000000,12.30970000,3.45671000,0.00000000,10.95670000,0.19030100,0.00000000,11.59620000,1.19004000,0.00000000,12.03930000,2.22362000,0.00000000,11.90960000,1.70888000,0.00000000,12.45200000,2.98773000,0.00000000,11.38890000,0.42132600,0.00000000,12.50000000,2.50000000,0.00000000,11.76780000,0.73223300,0.00000000,12.45200000,2.01227000,0.00000000,12.07870000,1.11107000,0.00000000,12.30970000,1.54329000,0.00000000,])
nodeIDs = np.array([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,])
elements = np.array([145,152,143,165,167,159,159,167,161,165,159,156,164,162,155,144,136,139,139,136,130,144,139,147,158,163,156,156,163,165,168,166,161,168,161,167,157,151,147,147,151,144,129,122,130,129,130,136,152,158,148,162,157,154,154,157,147,162,154,155,155,154,146,166,164,160,122,114,121,138,145,140,140,145,143,138,140,131,140,143,134,114,105,111,147,139,137,160,164,155,160,155,150,166,160,161,131,140,134,138,131,132,143,152,148,143,148,134,111,105,102,114,111,121,121,111,119,132,131,123,156,159,149,105,95,102,102,95,93,139,130,128,122,121,130,148,158,156,111,102,110,128,130,121,139,128,137,137,128,127,125,132,123,125,123,116,95,88,93,93,88,85,85,88,81,85,81,80,93,85,90,127,128,119,137,127,146,159,161,153,153,161,150,159,153,149,149,153,142,146,154,147,102,93,101,147,137,146,123,131,124,156,149,148,116,123,113,125,116,118,118,116,107,119,111,110,119,110,112,121,119,128,110,102,101,110,101,112,119,112,127,80,81,74,85,80,90,101,93,90,101,90,99,80,74,72,124,131,134,123,124,113,113,124,115,108,118,107,108,107,96,142,153,150,149,142,141,150,161,160,142,150,135,107,116,106,141,142,133,149,141,148,106,116,113,106,113,104,107,106,97,104,113,115,106,104,94,135,150,146,146,150,155,142,135,133,115,124,126,104,115,103,99,90,89,101,99,112,72,74,65,72,65,63,80,72,77,100,108,96,100,96,87,63,65,55,72,63,69,97,106,94,97,94,86,107,97,96,126,124,134,115,126,117,96,97,86,141,133,126,63,55,50,89,90,77,99,89,98,117,126,133,115,117,103,77,72,69,80,77,90,86,94,84,103,109,98,103,98,92,77,69,79,104,103,92,98,89,92,99,98,109,109,103,117,99,109,112,91,100,87,91,87,82,82,87,78,91,82,83,83,82,73,84,94,92,86,84,75,87,96,86,8,7,6,7,5,4,4,5,1,7,4,6,5,3,1,109,117,120,120,117,133,109,120,112,133,135,120,126,134,141,141,134,148,94,104,92,69,63,60,50,55,42,63,50,60,60,50,48,79,69,70,77,79,89,50,42,41,78,87,86,82,78,73,69,60,70,75,84,70,86,75,78,48,50,41,48,41,39,60,48,61,84,92,79,79,70,84,39,41,30,48,39,52,83,73,76,76,73,67,67,73,62,76,67,71,71,67,58,58,67,54,71,58,66,66,58,51,61,48,52,61,52,64,60,61,70,70,61,75,64,52,57,61,64,75,41,42,31,41,31,30,30,31,23,30,23,24,24,23,17,30,24,33,51,58,45,66,51,59,59,51,47,39,30,33,39,33,43,43,33,35,39,43,52,47,51,38,59,47,56,56,47,44,35,33,25,43,35,46,44,47,36,56,44,53,53,44,40,62,73,68,67,62,54,54,62,46,54,46,45,54,45,58,52,43,57,57,43,46,33,24,25,25,24,19,19,24,17,19,17,13,25,19,21,21,19,15,25,21,28,40,44,32,53,40,49,64,57,68,64,68,78,78,68,73,51,45,38,38,45,34,13,10,15,13,15,19,47,38,36,36,38,29,10,8,12,35,25,28,35,28,34,34,28,29,34,29,38,46,35,34,34,45,46,28,21,29,44,36,32,32,36,26,21,15,16,62,68,57,62,57,46,40,32,27,36,29,26,26,29,16,32,26,22,12,8,11,10,12,15,16,15,12,21,16,29,22,26,18,32,22,27,27,22,20,12,11,18,22,18,20,11,8,6,18,26,16,135,146,127,6,4,2,2,4,1,135,127,120,120,127,112,14,20,18,6,9,11,11,9,14,27,37,40,40,37,49,16,12,18,75,64,78,11,14,18,89,79,92,])
numNodesPerElem = np.array([3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,])



# Creating the mesh in the model part
print("Mesh 1 ::::: Length of Nodes = ",int(len(nodes)/3))
print("Mesh 1 ::::: Length of Elements = ",int(len(elements)/3))
print("Mesh 1 ::::: Length of nodeIDs = ",int(len(nodeIDs)))
print("Mesh 1 ::::: Length of numNodesPerElem = ",int(len(numNodesPerElem)))
print("Mesh 1 ::::: Maximum entry in elements vector = ", np.max(elements))
for i in range(0,int(len(nodes)/3)):
    mesh1_model_part.CreateNewNode(i+1, nodes[3*i+0], nodes[3*i+1], nodes[3*i+2])
print("Mesh 1 ::::: Finished adding nodes to model part !!")

# Creating elements with the above nodes
mesh1_model_part.AddProperties(Properties(1))
print("Mesh 1 ::::: Finished adding Properties to model part !!")
prp = mesh1_model_part.GetProperties()[1]
print("Mesh 1 ::::: Finished extracting properties from the model part !!")

for node in mesh1_model_part.Nodes:
    node.SetSolutionStepValue(PATCH_INDEX, 1)
    node.Set(INTERFACE,True)

for i in range(0,int(len(elements)/3)):
    sys.stdout.flush()
    mesh1_model_part.CreateNewCondition("Condition3D", i+1,[int(elements[3*i+0]),int(elements[3*i+1]),int(elements[3*i+2])],mesh1_model_part.GetProperties()[1])
print("Mesh 1 ::::: Finished Adding conditions to model part !!")

for cond in mesh1_model_part.Conditions:
    cond.Set(INTERFACE, True)
print("Mesh 1 ::::: Finished setting conditions in model part !!")
'''for cond in mesh1_model_part.Conditions:
    if cond.GetNode(0).GetSolutionStepValue(PATCH_INDEX) == 1.0 \
       and cond.GetNode(1).GetSolutionStepValue(PATCH_INDEX) == 1.0 \
       and cond.GetNode(2).GetSolutionStepValue(PATCH_INDEX) == 1.0 \
       and cond.GetNode(3).GetSolutionStepValue(PATCH_INDEX) == 1.0 :
        cond.Set(INTERFACE, True)
    else:
        cond.Set(INTERFACE, False)'''

print("Mesh 1 ::::: Finished adding Properties to model part !! Number of the conditions added to model part are : ", len(mesh1_model_part.Conditions))

## Importing the fine mesh

nodes = np.array([-1.15310000,7.16447000,0.00000000,-0.76873300,7.16447000,0.00000000,-1.15310000,6.71669000,0.00000000,-0.57655000,6.80502000,0.00000000,-0.38436700,7.16447000,0.00000000,-0.79829700,6.44164000,0.00000000,-1.15310000,6.26891000,0.00000000,-0.34659300,6.47183000,0.00000000,0.00000000,7.16447000,0.00000000,0.00000000,6.73158000,0.00000000,-0.75858700,5.88120000,0.00000000,-0.35811900,6.08223000,0.00000000,-1.15310000,5.82113000,0.00000000,0.00000000,6.29868000,0.00000000,-0.38064200,5.64049000,0.00000000,0.00000000,5.86579000,0.00000000,-0.78181500,5.45066000,0.00000000,-1.15310000,5.37335000,0.00000000,0.00000000,5.43289000,0.00000000,-0.40483100,5.21645000,0.00000000,-1.15310000,4.92557000,0.00000000,-0.83219200,4.92353000,0.00000000,0.00000000,5.00000000,0.00000000,-1.15310000,4.47779000,0.00000000,0.44776700,5.00000000,0.00000000,-0.30691000,4.60875000,0.00000000,-0.76384800,4.31305000,0.00000000,0.22388300,4.61029000,0.00000000,0.89553400,5.00000000,0.00000000,-1.15310000,4.03001000,0.00000000,0.66185400,4.58951000,0.00000000,-0.37440000,4.03210000,0.00000000,0.02119960,4.13949000,0.00000000,1.34330000,5.00000000,0.00000000,-0.76338900,3.80612000,0.00000000,0.46877300,4.18400000,0.00000000,1.12436000,4.61328000,0.00000000,-1.15310000,3.58223000,0.00000000,0.91398700,4.21783000,0.00000000,1.79107000,5.00000000,0.00000000,0.28414900,3.77458000,0.00000000,1.56813000,4.63683000,0.00000000,-0.24883400,3.46324000,0.00000000,1.36133000,4.24060000,0.00000000,0.69129500,3.71432000,0.00000000,-0.73395900,3.27394000,0.00000000,1.15710000,3.91263000,0.00000000,2.23883000,5.00000000,0.00000000,-1.15310000,3.13446000,0.00000000,2.00531000,4.61600000,0.00000000,1.80730000,4.27028000,0.00000000,0.27311400,3.24764000,0.00000000,-0.42380500,3.01973000,0.00000000,1.02458000,3.48625000,0.00000000,1.60177000,3.87470000,0.00000000,0.02587900,3.00420000,0.00000000,0.71736400,3.17733000,0.00000000,2.68660000,5.00000000,0.00000000,2.45340000,4.62016000,0.00000000,1.35831000,3.51428000,0.00000000,-1.15310000,2.68668000,0.00000000,2.23862000,4.23342000,0.00000000,-0.66152700,2.63787000,0.00000000,2.04621000,3.90929000,0.00000000,-0.21255700,2.62261000,0.00000000,0.30126200,2.75574000,0.00000000,1.14885000,3.11705000,0.00000000,1.79256000,3.53886000,0.00000000,2.89910000,4.62319000,0.00000000,3.13437000,5.00000000,0.00000000,2.67965000,4.26788000,0.00000000,0.87918700,2.76123000,0.00000000,1.59746000,3.13748000,0.00000000,2.48949000,3.86213000,0.00000000,-1.15310000,2.23890000,0.00000000,-0.48874900,2.24031000,0.00000000,2.24045000,3.50805000,0.00000000,1.34306000,2.77049000,0.00000000,-0.01079030,2.22384000,0.00000000,2.03022000,3.11136000,0.00000000,0.43663500,2.25330000,0.00000000,3.34330000,4.62825000,0.00000000,3.12564000,4.23604000,0.00000000,3.58213000,5.00000000,0.00000000,2.88407000,3.87023000,0.00000000,2.67264000,3.53269000,0.00000000,0.99753300,2.31728000,0.00000000,1.78892000,2.74577000,0.00000000,-0.69082700,1.85301000,0.00000000,-1.15310000,1.79112000,0.00000000,-0.20369100,1.86564000,0.00000000,2.47873000,3.13129000,0.00000000,0.24306300,1.85423000,0.00000000,1.54442000,2.36902000,0.00000000,3.32216000,3.88595000,0.00000000,3.78508000,4.63630000,0.00000000,2.22663000,2.76287000,0.00000000,3.57129000,4.24263000,0.00000000,0.66617500,1.87377000,0.00000000,4.02990000,5.00000000,0.00000000,3.11709000,3.48863000,0.00000000,-0.79031600,1.50658000,0.00000000,2.86739000,3.13075000,0.00000000,-0.39685400,1.47312000,0.00000000,1.11572000,1.87586000,0.00000000,2.02298000,2.36491000,0.00000000,0.00061537,1.47881000,0.00000000,-1.15310000,1.34334000,0.00000000,2.67252000,2.74131000,0.00000000,3.75688000,3.90323000,0.00000000,0.44871100,1.48188000,0.00000000,4.01458000,4.25256000,0.00000000,4.22335000,4.64797000,0.00000000,3.55500000,3.50519000,0.00000000,1.68060000,1.91778000,0.00000000,3.30360000,3.14305000,0.00000000,2.44163000,2.35690000,0.00000000,4.47767000,5.00000000,0.00000000,0.89139700,1.48628000,0.00000000,-0.59858800,1.08387000,0.00000000,3.09647000,2.74734000,0.00000000,-0.19687500,1.08296000,0.00000000,2.22486000,1.97127000,0.00000000,1.36507000,1.49190000,0.00000000,0.22160500,1.09559000,0.00000000,4.19087000,3.91316000,0.00000000,-1.15310000,0.89555900,0.00000000,2.89004000,2.35465000,0.00000000,3.98279000,3.51859000,0.00000000,4.45249000,4.26519000,0.00000000,0.65167800,1.11409000,0.00000000,4.65743000,4.66146000,0.00000000,3.74443000,3.13912000,0.00000000,3.52055000,2.75139000,0.00000000,1.10035000,1.13159000,0.00000000,2.67296000,1.97312000,0.00000000,4.92543000,5.00000000,0.00000000,-0.82775800,0.70022200,0.00000000,1.94464000,1.46319000,0.00000000,-0.39053100,0.68837400,0.00000000,3.33821000,2.36966000,0.00000000,0.01592760,0.69836300,0.00000000,4.62937000,3.90367000,0.00000000,2.45052000,1.58249000,0.00000000,4.40168000,3.51880000,0.00000000,0.45480800,0.71387100,0.00000000,1.53544000,1.07852000,0.00000000,4.87756000,4.27413000,0.00000000,3.13242000,2.02896000,0.00000000,4.19243000,3.12898000,0.00000000,-1.15310000,0.44777900,0.00000000,5.08919000,4.66617000,0.00000000,3.96617000,2.80091000,0.00000000,0.88812200,0.73590000,0.00000000,-0.61944500,0.36424300,0.00000000,2.87907000,1.65740000,0.00000000,1.23944000,0.75525200,0.00000000,3.78103000,2.39255000,0.00000000,5.36537000,5.00000000,0.00000000,-0.19218300,0.34908100,0.00000000,1.98109000,1.01746000,0.00000000,2.37492000,1.18289000,0.00000000,0.21513700,0.34588400,0.00000000,3.57974000,1.99192000,0.00000000,0.63964600,0.38022300,0.00000000,4.83877000,3.50651000,0.00000000,5.07501000,3.88832000,0.00000000,4.64043000,3.13957000,0.00000000,5.29663000,4.27149000,0.00000000,2.73190000,1.23605000,0.00000000,4.40011000,2.74368000,0.00000000,3.32759000,1.62476000,0.00000000,4.13219000,2.38593000,0.00000000,5.52234000,4.65601000,0.00000000,-1.15310000,0.00000000,0.00000000,-0.76873300,0.00000000,0.00000000,1.08336000,0.33487700,0.00000000,-0.38436700,0.00000000,0.00000000,0.00000000,0.00000000,0.00000000,3.94926000,1.99960000,0.00000000,5.77879000,5.00000000,0.00000000,1.52118000,0.40640200,0.00000000,3.08454000,1.24638000,0.00000000,2.30406000,0.75183900,0.00000000,0.44776700,0.00000000,0.00000000,5.51690000,3.91411000,0.00000000,5.08243000,3.13774000,0.00000000,3.77260000,1.60613000,0.00000000,4.57816000,2.43459000,0.00000000,5.31867000,3.51217000,0.00000000,2.68660000,0.77942300,0.00000000,0.89553400,0.00000000,0.00000000,4.85981000,2.74895000,0.00000000,2.01495000,0.38971100,0.00000000,5.76244000,4.28151000,0.00000000,5.95044000,4.68469000,0.00000000,3.53380000,1.22607000,0.00000000,1.34330000,0.00000000,0.00000000,6.16888000,5.00000000,0.00000000,4.52174000,2.00520000,0.00000000,2.46272000,0.38971100,0.00000000,3.13646000,0.77869600,0.00000000,1.79107000,0.00000000,0.00000000,4.23160000,1.54040000,0.00000000,4.95305000,2.32229000,0.00000000,5.73780000,3.52438000,0.00000000,5.53015000,3.11700000,0.00000000,5.95879000,3.91407000,0.00000000,3.92512000,1.17301000,0.00000000,6.16660000,4.30401000,0.00000000,5.30142000,2.67173000,0.00000000,6.33327000,4.70881000,0.00000000,2.91048000,0.38971100,0.00000000,2.23883000,0.00000000,0.00000000,3.58213000,0.77942300,0.00000000,6.53837000,5.00000000,0.00000000,2.68660000,0.00000000,0.00000000,3.35825000,0.38971100,0.00000000,5.00627000,1.82553000,0.00000000,6.52966000,4.35331000,0.00000000,5.98118000,3.14370000,0.00000000,6.39846000,3.95802000,0.00000000,6.21739000,3.54827000,0.00000000,4.02990000,0.77942300,0.00000000,5.45090000,2.24773000,0.00000000,4.78281000,1.43523000,0.00000000,6.73068000,4.71344000,0.00000000,5.80936000,2.67071000,0.00000000,4.43806000,1.02322000,0.00000000,6.88964000,5.00000000,0.00000000,3.13437000,0.00000000,0.00000000,3.80602000,0.38971100,0.00000000,5.46494000,1.82098000,0.00000000,7.02603000,4.76219000,0.00000000,5.23176000,1.43641000,0.00000000,3.58213000,0.00000000,0.00000000,5.86075000,2.15670000,0.00000000,6.89059000,4.04409000,0.00000000,6.56914000,3.28007000,0.00000000,6.76536000,3.68457000,0.00000000,7.22475000,5.00000000,0.00000000,7.06713000,4.45631000,0.00000000,6.36878000,2.87927000,0.00000000,4.25378000,0.38971100,0.00000000,5.01146000,1.04886000,0.00000000,6.17233000,2.47884000,0.00000000,4.79449000,0.65998600,0.00000000,7.33503000,4.73852000,0.00000000,4.02990000,0.00000000,0.00000000,5.91475000,1.81053000,0.00000000,5.68060000,1.42632000,0.00000000,7.54550000,5.00000000,0.00000000,5.44434000,1.04457000,0.00000000,6.81561000,2.91278000,0.00000000,7.01746000,3.31381000,0.00000000,7.20732000,3.71998000,0.00000000,6.62134000,2.50741000,0.00000000,7.37559000,4.09233000,0.00000000,6.42181000,2.10442000,0.00000000,5.22541000,0.65831900,0.00000000,4.47767000,0.00000000,0.00000000,7.56377000,4.46467000,0.00000000,7.70257000,4.75513000,0.00000000,5.06718000,0.32632100,0.00000000,7.85348000,5.00000000,0.00000000,6.13046000,1.41561000,0.00000000,5.90566000,1.02040000,0.00000000,4.92543000,0.00000000,0.00000000,7.44921000,3.34746000,0.00000000,7.26361000,2.94210000,0.00000000,5.65076000,0.65149100,0.00000000,7.96751000,4.79942000,0.00000000,7.63228000,3.75214000,0.00000000,7.06506000,2.53856000,0.00000000,6.87887000,2.08108000,0.00000000,7.98996000,4.53839000,0.00000000,6.67199000,1.73047000,0.00000000,5.50898000,0.34121100,0.00000000,7.87378000,4.07260000,0.00000000,8.15010000,5.00000000,0.00000000,5.36537000,0.00000000,0.00000000,8.23858000,4.78985000,0.00000000,6.16309000,0.62887900,0.00000000,8.43662000,5.00000000,0.00000000,7.97568000,3.48403000,0.00000000,8.25008000,4.23913000,0.00000000,5.94336000,0.31808400,0.00000000,7.06030000,1.70424000,0.00000000,8.36745000,4.51564000,0.00000000,7.77880000,2.90119000,0.00000000,7.58353000,2.43794000,0.00000000,5.77879000,0.00000000,0.00000000,6.62781000,0.93083300,0.00000000,8.52686000,4.77330000,0.00000000,6.93350000,1.27124000,0.00000000,8.32914000,3.93752000,0.00000000,7.43271000,1.90140000,0.00000000,8.71416000,5.00000000,0.00000000,8.50931000,4.19201000,0.00000000,6.51802000,0.55061500,0.00000000,6.33294000,0.30184500,0.00000000,8.65572000,4.49242000,0.00000000,6.16888000,0.00000000,0.00000000,8.82029000,4.75397000,0.00000000,7.32449000,1.33849000,0.00000000,8.26134000,2.90813000,0.00000000,6.83870000,0.61411500,0.00000000,8.98375000,5.00000000,0.00000000,7.19752000,0.97511600,0.00000000,8.08602000,2.36921000,0.00000000,8.83944000,4.24393000,0.00000000,7.87499000,1.97520000,0.00000000,8.92474000,4.54096000,0.00000000,6.69796000,0.29342600,0.00000000,8.53472000,3.25309000,0.00000000,8.83982000,3.97883000,0.00000000,7.72207000,1.55886000,0.00000000,6.53837000,0.00000000,0.00000000,8.75118000,3.62851000,0.00000000,9.11504000,4.77334000,0.00000000,9.24632000,5.00000000,0.00000000,9.08428000,4.21949000,0.00000000,7.22575000,0.58032700,0.00000000,7.61124000,1.08172000,0.00000000,7.04839000,0.28703600,0.00000000,9.22208000,4.49843000,0.00000000,8.69955000,2.94948000,0.00000000,6.88964000,0.00000000,0.00000000,8.51478000,2.39306000,0.00000000,7.50846000,0.73022500,0.00000000,8.31260000,1.98394000,0.00000000,9.37451000,4.75101000,0.00000000,8.11950000,1.60515000,0.00000000,8.95185000,3.31100000,0.00000000,9.10038000,3.66211000,0.00000000,9.50271000,5.00000000,0.00000000,7.97827000,1.25152000,0.00000000,9.28202000,3.97278000,0.00000000,7.37848000,0.34474500,0.00000000,9.39136000,4.26945000,0.00000000,9.51484000,4.52143000,0.00000000,7.83601000,0.79259400,0.00000000,7.22475000,0.00000000,0.00000000,9.62820000,4.75626000,0.00000000,8.94805000,2.53640000,0.00000000,7.71803000,0.47088300,0.00000000,9.75369000,5.00000000,0.00000000,9.28638000,3.32997000,0.00000000,9.14039000,2.94552000,0.00000000,8.70254000,1.97713000,0.00000000,8.55714000,1.68013000,0.00000000,9.56157000,4.00623000,0.00000000,9.46019000,3.66866000,0.00000000,8.37010000,1.31844000,0.00000000,9.69686000,4.28532000,0.00000000,9.77404000,4.54988000,0.00000000,8.26102000,0.97211100,0.00000000,7.54550000,0.00000000,0.00000000,9.87685000,4.78073000,0.00000000,10.00000000,5.00000000,0.00000000,8.12182000,0.55233500,0.00000000,9.49236000,3.01937000,0.00000000,7.92718000,0.20794600,0.00000000,9.66829000,3.34793000,0.00000000,9.97144000,4.32144000,0.00000000,9.81406000,3.74188000,0.00000000,9.11088000,1.99785000,0.00000000,8.76234000,1.33376000,0.00000000,7.85348000,0.00000000,0.00000000,8.58373000,1.02483000,0.00000000,10.11680000,4.81101000,0.00000000,8.95917000,1.65883000,0.00000000,9.96792000,4.04348000,0.00000000,9.41590000,2.50229000,0.00000000,10.12930000,4.54336000,0.00000000,8.48969000,0.73838000,0.00000000,10.24500000,4.98796000,0.00000000,8.23944000,0.24646000,0.00000000,8.38136000,0.43797300,0.00000000,9.95879000,3.41811000,0.00000000,10.33270000,4.74301000,0.00000000,8.15010000,0.00000000,0.00000000,10.23930000,4.26901000,0.00000000,9.25733000,1.65653000,0.00000000,8.91595000,1.01167000,0.00000000,9.78774000,2.73392000,0.00000000,9.09298000,1.30315000,0.00000000,8.79764000,0.77030000,0.00000000,10.16250000,3.70841000,0.00000000,9.50406000,1.98730000,0.00000000,10.48770000,4.95196000,0.00000000,10.41220000,4.50879000,0.00000000,9.98229000,3.05512000,0.00000000,8.66890000,0.47406400,0.00000000,10.53950000,4.73557000,0.00000000,8.55218000,0.20387300,0.00000000,10.35630000,3.95717000,0.00000000,8.43662000,0.00000000,0.00000000,10.27200000,3.35970000,0.00000000,9.23283000,0.99211000,0.00000000,9.08270000,0.74149900,0.00000000,9.41470000,1.29998000,0.00000000,10.72570000,4.89235000,0.00000000,8.92578000,0.47379900,0.00000000,9.92783000,2.29564000,0.00000000,10.61280000,4.24367000,0.00000000,9.62301000,1.59216000,0.00000000,8.81224000,0.21700000,0.00000000,10.49370000,3.65023000,0.00000000,10.73900000,4.58172000,0.00000000,8.71416000,0.00000000,0.00000000,10.19540000,2.60444000,0.00000000,9.86569000,1.85395000,0.00000000,10.66660000,3.91177000,0.00000000,9.34784000,0.72356200,0.00000000,10.95670000,4.80970000,0.00000000,9.20429000,0.45600800,0.00000000,9.08749000,0.24426700,0.00000000,9.56295000,0.97458700,0.00000000,9.75385000,1.25803000,0.00000000,10.50150000,2.90235000,0.00000000,10.65780000,3.34919000,0.00000000,8.98375000,0.00000000,0.00000000,10.93920000,4.32304000,0.00000000,11.00360000,4.56432000,0.00000000,10.90120000,4.02966000,0.00000000,10.02830000,1.53972000,0.00000000,11.17850000,4.70480000,0.00000000,10.47170000,2.34564000,0.00000000,9.51111000,0.45645000,0.00000000,11.16120000,4.43738000,0.00000000,10.96880000,3.67813000,0.00000000,9.37739000,0.21509800,0.00000000,10.29280000,1.85504000,0.00000000,9.24632000,0.00000000,0.00000000,11.15390000,4.18336000,0.00000000,9.74760000,0.68193000,0.00000000,9.95870000,0.97336300,0.00000000,10.15120000,1.26006000,0.00000000,11.33620000,4.36044000,0.00000000,11.38890000,4.57867000,0.00000000,9.76319000,0.44602600,0.00000000,9.62633000,0.21607700,0.00000000,9.50271000,0.00000000,0.00000000,11.05310000,3.15555000,0.00000000,11.26760000,3.83168000,0.00000000,10.84440000,2.51119000,0.00000000,11.24330000,3.47306000,0.00000000,10.48300000,1.41906000,0.00000000,9.96712000,0.47261800,0.00000000,10.81760000,2.12956000,0.00000000,10.13250000,0.72202300,0.00000000,11.49010000,4.12871000,0.00000000,11.58600000,4.43253000,0.00000000,9.87685000,0.20376400,0.00000000,9.75369000,0.00000000,0.00000000,10.37590000,1.02468000,0.00000000,11.20650000,2.63577000,0.00000000,11.51170000,3.53673000,0.00000000,10.85880000,1.71823000,0.00000000,11.60170000,3.80212000,0.00000000,11.12560000,2.32199000,0.00000000,11.46580000,3.19924000,0.00000000,10.11160000,0.22856600,0.00000000,11.76780000,4.26777000,0.00000000,11.71720000,4.02310000,0.00000000,10.44310000,0.74643700,0.00000000,10.00000000,0.00000000,0.00000000,10.31950000,0.47072600,0.00000000,10.71520000,1.14589000,0.00000000,11.49840000,2.78728000,0.00000000,11.84260000,3.86655000,0.00000000,10.33660000,0.23080100,0.00000000,11.71200000,3.31547000,0.00000000,10.71550000,0.87273100,0.00000000,11.93250000,4.08598000,0.00000000,10.24500000,0.01203820,0.00000000,11.27960000,1.96843000,0.00000000,11.01360000,1.36985000,0.00000000,11.85620000,3.64737000,0.00000000,11.47980000,2.36503000,0.00000000,10.69670000,0.58567800,0.00000000,10.54880000,0.30896100,0.00000000,11.76330000,2.95709000,0.00000000,10.98810000,1.04312000,0.00000000,11.26640000,1.56748000,0.00000000,12.07870000,3.88893000,0.00000000,10.48770000,0.04803680,0.00000000,11.74940000,2.60309000,0.00000000,12.04170000,3.44330000,0.00000000,10.76090000,0.37330600,0.00000000,10.97310000,0.73683000,0.00000000,11.23450000,1.23231000,0.00000000,12.20480000,3.67849000,0.00000000,11.77030000,2.29941000,0.00000000,10.72570000,0.10764900,0.00000000,10.96570000,0.45813200,0.00000000,11.69130000,1.96786000,0.00000000,12.12450000,3.11470000,0.00000000,11.60150000,1.66998000,0.00000000,12.02950000,2.72278000,0.00000000,11.30670000,0.90626500,0.00000000,12.30970000,3.45671000,0.00000000,10.95670000,0.19030100,0.00000000,11.16580000,0.55505300,0.00000000,11.54060000,1.29039000,0.00000000,12.04930000,2.40487000,0.00000000,12.27170000,2.83630000,0.00000000,12.39240000,3.22571000,0.00000000,11.99700000,2.04282000,0.00000000,11.17850000,0.29519700,0.00000000,11.88070000,1.72100000,0.00000000,11.38990000,0.65021000,0.00000000,11.78650000,1.45475000,0.00000000,12.26480000,2.61126000,0.00000000,11.51450000,0.77972400,0.00000000,11.65960000,0.97654100,0.00000000,12.45200000,2.98773000,0.00000000,11.38890000,0.42132600,0.00000000,12.29130000,2.38744000,0.00000000,12.24300000,2.16728000,0.00000000,11.89460000,1.22772000,0.00000000,12.48800000,2.74504000,0.00000000,11.58600000,0.56747400,0.00000000,12.22530000,1.94260000,0.00000000,12.14540000,1.73237000,0.00000000,12.05980000,1.52578000,0.00000000,12.50000000,2.50000000,0.00000000,11.76780000,0.73223300,0.00000000,12.48800000,2.25496000,0.00000000,11.93250000,0.91401700,0.00000000,12.45200000,2.01227000,0.00000000,12.07870000,1.11107000,0.00000000,12.39240000,1.77429000,0.00000000,12.20480000,1.32151000,0.00000000,12.30970000,1.54329000,0.00000000,])
nodeIDs = np.array([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,])
elements = np.array([468,477,464,529,531,517,517,531,522,529,517,516,528,523,515,465,454,453,453,454,440,465,453,466,504,511,497,536,534,526,503,494,490,416,403,410,410,403,395,416,410,425,488,496,483,533,535,522,533,522,531,518,509,499,499,503,490,518,499,508,441,428,431,519,524,513,532,530,521,487,476,472,472,476,466,472,466,461,487,480,494,466,476,465,391,377,381,477,488,473,473,488,483,477,473,464,473,483,469,464,473,469,523,518,508,523,508,515,515,508,501,454,441,440,440,441,431,440,431,436,511,519,505,534,532,525,525,532,521,534,525,526,525,521,510,526,525,510,494,480,490,403,391,395,395,391,381,395,381,392,496,504,491,535,536,527,509,503,499,428,416,425,428,425,431,431,425,424,524,529,516,524,516,513,513,516,502,530,528,520,520,528,515,530,520,521,520,515,507,521,520,507,377,360,371,456,468,455,455,468,464,456,455,443,455,464,450,360,347,359,392,381,375,395,392,410,461,466,453,472,461,480,424,425,410,431,424,436,508,499,501,536,526,527,527,526,512,519,513,505,505,513,502,535,527,522,444,456,443,444,443,433,433,443,430,444,433,435,347,336,344,443,455,442,359,347,344,359,344,356,360,359,371,371,359,375,371,375,381,371,381,377,435,433,418,356,344,341,359,356,375,440,436,453,336,321,332,516,517,502,436,424,426,511,505,497,497,505,492,515,501,507,507,501,489,341,344,332,332,344,336,356,341,355,423,435,418,321,308,320,320,308,304,321,320,332,332,320,326,512,526,510,527,512,514,492,505,502,497,492,482,423,418,408,442,455,450,442,450,437,437,450,452,442,437,430,442,430,443,483,496,491,483,491,482,482,491,497,497,491,504,480,461,459,472,480,487,341,332,326,411,423,408,411,408,396,396,408,394,411,396,398,398,396,378,308,298,304,304,298,294,355,341,340,356,355,365,517,522,506,506,522,514,517,506,502,433,430,417,298,284,294,294,284,282,408,418,404,459,461,446,480,459,474,510,521,507,469,483,482,355,340,352,408,404,394,394,404,388,340,341,326,404,418,417,417,418,433,404,417,401,514,512,500,527,514,522,450,464,469,500,512,498,514,500,506,392,375,383,340,326,322,382,398,378,382,378,363,284,280,282,282,280,272,272,280,265,272,265,263,282,272,276,294,282,289,304,294,302,396,394,379,379,394,376,396,379,378,378,379,361,326,320,313,320,304,313,313,304,302,313,302,311,392,383,406,406,383,397,392,406,410,382,363,369,369,363,358,383,375,365,365,375,356,383,365,373,363,378,361,426,424,406,436,426,446,417,430,415,482,492,475,475,492,485,482,475,467,474,459,463,480,474,490,452,450,469,437,452,438,263,265,252,263,252,248,272,263,276,326,313,322,467,475,457,482,467,469,469,467,452,365,355,373,289,282,276,289,276,286,286,276,279,289,299,302,289,302,294,415,430,437,417,415,401,401,415,400,400,415,419,401,400,385,489,501,484,507,489,495,495,489,481,507,495,510,438,452,457,437,438,419,510,495,498,510,498,512,311,302,299,313,311,322,322,311,316,404,401,388,388,401,385,388,385,370,500,498,478,340,322,338,452,467,457,352,340,338,352,338,353,355,352,373,338,322,316,457,475,470,470,475,485,470,485,479,457,470,449,385,400,387,446,461,453,459,446,448,448,446,432,459,448,463,463,448,445,376,394,388,376,388,370,376,370,357,379,376,361,343,358,339,339,358,346,343,339,325,252,241,248,248,241,234,234,241,230,234,230,227,248,234,242,485,492,502,316,311,299,474,463,484,484,501,499,489,484,471,471,484,463,489,471,481,495,481,498,432,446,426,448,432,445,478,498,481,500,478,486,357,370,354,376,357,361,485,502,493,493,502,506,485,493,479,479,493,486,479,486,460,383,373,397,397,373,389,389,373,366,397,389,409,470,479,449,419,415,437,400,419,402,406,397,414,414,397,409,406,414,426,426,414,432,370,385,368,299,289,286,299,286,296,296,286,279,299,296,316,328,343,325,328,325,314,363,361,346,263,248,262,409,389,399,325,339,323,486,493,506,279,276,262,227,230,216,227,216,212,234,227,242,387,400,402,387,402,384,385,387,368,368,387,372,262,248,242,263,262,276,323,339,330,325,323,307,346,361,342,342,361,357,346,342,330,330,342,324,346,330,339,323,330,309,363,346,358,486,478,460,500,486,506,366,373,352,389,366,380,318,328,314,318,314,301,314,325,307,314,307,300,353,338,335,352,353,366,338,316,335,335,316,319,463,445,471,414,409,432,380,366,364,389,380,399,399,380,393,479,460,449,212,216,199,212,199,196,227,212,220,300,307,293,314,300,301,301,300,283,457,449,439,481,471,458,458,471,445,481,458,462,462,458,447,481,462,478,370,368,354,402,419,420,420,419,438,402,420,407,420,438,439,439,438,457,353,335,348,407,420,427,402,407,384,427,420,439,427,439,449,407,427,413,357,354,337,409,399,422,422,399,421,409,422,432,318,301,303,303,301,287,324,342,337,330,324,309,319,316,296,335,319,334,490,474,499,262,242,258,384,407,390,424,410,406,372,387,384,372,384,367,367,384,390,372,367,350,368,372,351,293,307,309,300,293,283,348,335,334,348,334,349,353,348,364,334,319,315,364,348,362,362,348,349,362,349,374,364,362,393,353,364,366,380,364,393,196,199,181,196,181,174,212,196,210,9,5,10,2,1,3,176,178,155,5,2,4,175,176,151,178,179,160,453,436,446,447,458,445,462,447,451,451,447,429,462,451,478,307,323,309,287,301,283,287,283,271,303,287,292,292,287,278,258,242,238,238,242,220,258,238,256,262,258,279,354,368,351,155,178,160,155,160,140,176,155,151,421,399,393,421,393,412,367,390,374,140,160,142,155,140,138,474,484,499,413,427,434,407,413,390,390,413,405,337,354,333,333,354,351,337,333,317,357,337,342,160,179,163,317,333,312,337,317,324,351,372,350,351,350,331,331,350,329,351,331,333,374,349,345,362,374,386,220,212,210,220,210,222,227,220,242,422,421,445,445,421,447,142,160,163,142,163,146,140,142,122,4,2,3,5,4,10,163,179,185,429,447,421,451,429,434,350,367,345,256,238,240,258,256,273,386,374,405,386,405,412,362,386,393,393,386,412,349,334,327,281,292,278,281,278,264,181,159,174,174,159,152,222,210,208,220,222,238,163,185,165,315,319,296,334,315,327,327,315,306,333,331,312,165,185,192,163,165,146,146,165,154,273,256,269,258,273,279,309,324,305,305,324,317,309,305,295,295,305,288,309,295,293,196,174,195,23,19,20,16,14,12,12,14,8,16,12,15,19,16,15,14,10,8,152,159,137,152,137,132,132,137,118,132,118,113,152,132,148,174,152,169,154,165,177,146,154,131,19,15,20,20,15,17,8,10,4,8,4,6,6,4,3,8,6,12,278,287,271,278,271,260,260,271,253,278,260,264,264,260,247,247,260,245,264,247,261,113,118,100,113,100,96,132,113,130,405,434,429,390,405,374,138,140,120,155,138,151,151,138,127,127,138,120,210,196,195,210,195,208,208,195,186,312,331,310,96,100,84,96,84,82,113,96,112,142,146,125,122,142,125,122,125,107,140,122,120,120,122,104,104,122,107,104,107,91,120,104,102,91,107,93,104,91,89,268,281,264,268,264,261,306,315,285,327,306,329,349,327,345,186,195,169,186,169,167,82,84,70,82,70,69,222,208,223,208,186,206,96,82,98,421,412,429,429,412,405,107,125,111,15,12,11,167,169,148,148,169,152,167,148,143,186,167,190,317,312,297,240,238,222,256,240,255,271,283,267,434,427,449,17,15,11,17,11,13,13,11,7,413,434,405,20,17,22,269,256,255,269,255,270,273,269,285,253,271,267,260,253,245,245,253,235,69,70,58,69,58,59,82,69,83,195,174,169,148,132,130,148,130,143,143,130,126,126,130,112,126,112,110,110,112,98,110,98,95,126,110,129,95,98,83,95,83,85,110,95,114,143,126,145,112,130,113,85,83,71,95,85,101,98,112,96,247,245,229,269,270,290,69,59,71,71,59,62,69,71,83,62,59,50,71,62,74,167,143,166,245,235,226,270,255,254,235,253,251,59,58,48,59,48,50,83,98,82,177,165,192,177,192,198,177,198,182,182,198,203,177,182,157,131,154,135,126,129,145,145,129,150,150,129,133,145,150,168,154,177,157,154,157,135,135,157,147,147,157,182,135,147,124,146,131,125,125,131,111,111,131,119,119,131,135,111,119,99,119,135,124,129,110,114,129,114,133,133,114,116,116,114,101,133,116,134,101,114,95,116,101,103,103,101,86,116,103,121,86,101,85,86,85,74,74,85,71,86,74,77,77,74,64,86,77,92,64,74,62,64,62,51,51,62,50,64,51,55,51,50,42,42,50,40,51,42,44,40,50,48,42,40,34,42,34,37,37,34,29,42,37,44,44,37,39,77,64,68,86,92,103,103,92,109,109,92,97,103,109,121,121,109,128,128,109,117,121,128,141,64,55,68,68,55,60,60,55,47,68,60,73,92,77,80,55,51,44,55,44,47,47,44,39,47,39,45,45,39,36,47,45,54,97,92,80,97,80,88,88,80,73,97,88,106,73,80,68,88,73,78,73,60,67,109,97,117,60,47,54,60,54,67,67,54,57,57,54,45,67,57,72,72,57,66,67,72,78,67,78,73,116,121,134,134,121,141,134,141,158,158,141,164,134,158,153,45,36,41,88,78,94,36,39,31,310,331,329,310,329,306,93,107,111,93,111,99,93,99,81,81,99,87,93,81,79,89,91,76,106,88,94,312,310,291,91,93,79,91,79,76,76,79,65,65,79,66,76,65,63,104,89,102,102,89,90,97,106,117,117,106,123,123,106,115,117,123,136,120,108,127,143,145,166,166,145,168,166,168,187,187,168,193,166,187,190,190,187,207,124,147,139,285,315,296,306,285,290,61,75,63,236,249,232,203,214,194,29,25,31,24,30,27,90,108,102,102,108,120,39,37,31,18,21,22,22,21,24,217,231,213,133,134,153,133,153,150,150,153,171,171,153,173,150,171,168,173,153,158,173,158,180,180,158,164,173,180,200,180,164,188,200,180,204,173,200,189,188,164,172,180,188,204,172,164,149,188,172,197,204,188,209,209,188,197,204,209,229,171,173,189,171,189,193,193,189,205,205,189,200,193,205,211,38,49,46,75,90,89,249,261,244,13,18,17,17,18,22,214,217,201,25,23,28,30,38,35,231,236,218,3,7,6,6,7,11,49,61,63,223,208,206,123,115,139,207,187,211,11,12,6,117,136,128,128,136,149,128,149,141,141,149,164,206,186,190,206,190,207,190,167,166,99,119,105,222,223,240,115,106,94,115,94,105,136,123,144,193,168,171,187,193,211,297,312,291,267,283,293,87,99,105,255,240,239,79,81,66,317,297,305,81,87,72,20,22,26,211,205,225,200,204,226,245,226,229,229,226,204,197,172,183,269,290,285,235,251,233,247,229,244,270,254,274,77,68,80,254,255,239,254,239,243,243,239,221,223,239,240,254,243,257,290,270,291,226,235,219,251,253,267,172,149,156,37,29,31,45,52,57,36,31,28,28,31,25,76,63,75,72,66,81,89,76,75,291,310,290,124,139,115,66,57,52,94,78,87,63,65,53,139,147,161,41,36,33,232,249,244,232,244,224,46,49,63,35,38,46,35,46,43,254,257,274,274,257,275,275,257,259,274,275,297,43,46,53,35,43,32,259,257,246,27,30,35,27,35,32,27,32,26,201,217,213,201,213,191,191,213,202,201,191,184,105,119,124,211,225,228,194,214,201,194,201,184,194,184,161,161,184,162,162,184,191,161,162,139,244,261,247,218,236,232,218,232,215,215,232,224,215,224,209,209,224,229,218,215,202,202,215,197,218,202,213,218,213,231,197,215,209,20,26,23,28,23,26,144,123,139,26,22,27,275,259,277,24,27,22,257,243,246,246,243,228,246,228,237,237,228,225,237,225,233,233,225,219,246,237,259,203,194,182,225,205,219,136,144,156,156,144,170,136,156,149,170,144,162,162,144,139,170,162,191,156,170,183,183,170,202,224,244,229,183,172,156,33,36,28,53,65,56,56,65,66,56,66,52,56,52,43,53,56,43,32,43,41,233,251,250,250,251,266,233,250,237,237,250,259,52,45,41,277,259,266,219,235,233,161,147,182,197,183,202,41,33,32,32,33,26,26,33,28,211,228,207,270,274,291,63,53,46,191,202,170,226,219,200,275,277,288,288,277,295,266,251,267,250,266,259,374,345,367,288,305,297,288,297,275,87,105,94,266,267,293,329,350,345,422,445,432,329,345,327,206,207,221,221,207,228,206,221,223,105,124,115,78,72,87,460,478,451,460,451,434,223,221,239,243,221,228,434,449,460,295,277,266,295,266,293,296,279,285,279,273,285,182,194,161,297,291,274,219,205,200,52,41,43,306,290,310,])
numNodesPerElem = np.array([3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,])


#Adding model part for second Mesh
print("Mesh 2 ::::: Length of Nodes = ",int(len(nodes)/3))
print("Mesh 2 ::::: Length of Elements = ",int(len(elements)/3))
print("Mesh 2 ::::: Length of nodeIDs = ",int(len(nodeIDs)))
print("Mesh 2 ::::: Length of numNodesPerElem = ",int(len(numNodesPerElem)))
print("Mesh 2 ::::: Maximum entry in elements vector = ", np.max(elements))
for i in range(0,int(len(nodes)/3)):
    mesh2_model_part.CreateNewNode(i+1, nodes[3*i+0], nodes[3*i+1], nodes[3*i+2])

for node in mesh2_model_part.Nodes:
    node.SetSolutionStepValue(PATCH_INDEX, 1)
    node.Set(INTERFACE, True)

mesh2_model_part.AddProperties(Properties(1))
for i in range(0,int(len(elements)/3)):
    sys.stdout.flush()
    mesh2_model_part.CreateNewCondition("Condition3D", i+1,[int(elements[3*i+0]),int(elements[3*i+1]),int(elements[3*i+2])], mesh2_model_part.GetProperties()[1])

for cond in mesh2_model_part.Conditions:
    cond.Set(INTERFACE, True)
print("Mesh 2 ::::: Finished setting conditions in model part !!")
'''for cond in mesh2_model_part.Conditions:
    if cond.GetNode(0).GetSolutionStepValue(PATCH_INDEX) == 1.0 \
       and cond.GetNode(1).GetSolutionStepValue(PATCH_INDEX) == 1.0 \
       and cond.GetNode(2).GetSolutionStepValue(PATCH_INDEX) == 1.0 \
       and cond.GetNode(3).GetSolutionStepValue(PATCH_INDEX) == 1.0 :
        cond.Set(INTERFACE, True)
    else:
        cond.Set(INTERFACE, False)'''

## Creating field on mesh1 
## This is just a pseudo field 
## Field[0] = sin(x+y^2)
## Field[1] = cos(y+z^2)
## Field[2] = sin(z+x^2)

for node in mesh1_model_part.Nodes:
    x = node.X
    y = node.Y
    z = node.Z
    fx = np.sin(x + y*y)
    fy = np.cos(y + z*z)
    fz = np.sin(z + x*x)
    '''print("fx = ", fx)
    print("fy = ", fy)
    print("fz = ", fz)
    print("##########")'''
    node.SetSolutionStepValue(DISPLACEMENT_X, fx)
    node.SetSolutionStepValue(DISPLACEMENT_Y, fy)
    node.SetSolutionStepValue(DISPLACEMENT_Z, fz)


## Creating the mapper
isDual = 0
isOppSurfNormal = 0
isEnforceConsistancy = 0 
#mapper = empire_mapper.FiniteElementMapper("default",3,mesh1_model_part,mesh2_model_part,0,0,0)
mapper = empire_mapper.FiniteElementMapper("default",3,mesh1_model_part,mesh2_model_part,isDual,isOppSurfNormal,isEnforceConsistancy)
print("############### Successfully created mapper !!")

mapper.doMapping(mesh1_model_part,DISPLACEMENT,mesh2_model_part,VELOCITY)

norm = 0
## Validating the mapped values
for node in mesh2_model_part.Nodes:
    cvalx = node.GetSolutionStepValue(VELOCITY_X)
    cvaly = node.GetSolutionStepValue(VELOCITY_Y)
    cvalz = node.GetSolutionStepValue(VELOCITY_Z)
    #
    print("cvalx = ", cvalx)
    print("cvaly = ", cvaly)
    print("cvalz = ", cvalz)
    print("##########")
    # Calculating the analytical value
    #
    x = node.X
    y = node.Y
    z = node.Z
    avalx = np.sin(x + y*y)
    avaly = np.cos(y + z*z)
    avalz = np.sin(z + x*x)
    print("avalx = ", avalx)
    print("avaly = ", avaly)
    print("avalz = ", avalz)
    print("##########")
    
    #norm += la.norm(np.array([cvalx-avalx, cvaly-avaly, cvalz-avalz]), np.inf)
    norm += la.norm(np.array([cvalx-avalx, cvaly-avaly, cvalz-avalz]), np.inf)

norm = norm/len(mesh2_model_part.Nodes)   
print("Norm of the difference between the mapped and analytical fields is : ",norm)

    
